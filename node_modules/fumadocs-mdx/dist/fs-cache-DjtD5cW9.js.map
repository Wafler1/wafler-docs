{"version":3,"file":"fs-cache-DjtD5cW9.js","names":[],"sources":["../src/utils/fs-cache.ts"],"sourcesContent":["import fs from 'node:fs/promises';\nimport path from 'node:path';\n\nconst map = new Map<string, Promise<string>>();\n\nexport function createFSCache() {\n  return {\n    read(file: string): Promise<string> {\n      const fullPath = toFullPath(file);\n      const cached = map.get(fullPath);\n      if (cached) return cached;\n\n      const read = fs.readFile(fullPath).then((s) => s.toString());\n      map.set(fullPath, read);\n      return read;\n    },\n\n    delete(file: string) {\n      map.delete(toFullPath(file));\n    },\n  };\n}\n\n/**\n * make file paths relative to cwd\n */\nfunction toFullPath(file: string) {\n  if (path.isAbsolute(file)) {\n    return path.relative(process.cwd(), file);\n  }\n\n  return file;\n}\n"],"mappings":";;;;AAGA,MAAM,sBAAM,IAAI,KAA8B;AAE9C,SAAgB,gBAAgB;AAC9B,QAAO;EACL,KAAK,MAA+B;GAClC,MAAM,WAAW,WAAW,KAAK;GACjC,MAAM,SAAS,IAAI,IAAI,SAAS;AAChC,OAAI,OAAQ,QAAO;GAEnB,MAAM,OAAO,GAAG,SAAS,SAAS,CAAC,MAAM,MAAM,EAAE,UAAU,CAAC;AAC5D,OAAI,IAAI,UAAU,KAAK;AACvB,UAAO;;EAGT,OAAO,MAAc;AACnB,OAAI,OAAO,WAAW,KAAK,CAAC;;EAE/B;;;;;AAMH,SAAS,WAAW,MAAc;AAChC,KAAI,KAAK,WAAW,KAAK,CACvB,QAAO,KAAK,SAAS,QAAQ,KAAK,EAAE,KAAK;AAG3C,QAAO"}